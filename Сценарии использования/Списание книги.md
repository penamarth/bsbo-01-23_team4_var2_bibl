# Сценарий списания книги

## Начало операции

1. Библиотекарь выбирает операцию "Списать книгу" в системе.
2. Система запрашивает идентификатор списываемой книги.

## Поиск книги

3. Библиотекарь вводит номер книги (сканирует штрих-код или вводит вручную).
4. Система ищет книгу по идентификатору.

## Проверка существования книги

5. Если книга не найдена:
   - Система показывает сообщение: "Книга не найдена".
   - Сценарий завершается.

## Проверка статуса книги

6. Если книга найдена:
   - Система проверяет текущий статус книги.

7. Если книга выдана читателю (isAvailable = false):
   - Система показывает сообщение: "Нельзя списать книгу, которая выдана".
   - Сценарий завершается.

## Списание книги

8. Если книга доступна (isAvailable = true):
   - Система удаляет книгу из каталога.
   - Система сохраняет изменения.

## Завершение операции

9. Система показывает сообщение: "Книга списана из фонда".
10. Операция завершена.

```plantuml
@startuml
title Диаграмма последовательности — Прецедент "Списать книгу"

actor Librarian
participant "Library" as Lib
participant "IBookRepository" as BookRepo <<interface>>
participant "Catalog" as Catalog
participant "Shelf"
participant "Cell"
participant "Book"

Librarian -> Lib : WriteOffBook(bookId)

Lib -> BookRepo : GetBookById(bookId)
BookRepo --> Lib : book / null

alt "Книга не найдена"
    Lib --> Librarian : "Книга не найдена"
else
    alt "Книга выдана"
        Lib --> Librarian : "Нельзя списать книгу, пока она выдана"
    else
        Lib -> Catalog : найти шкаф и ячейку с этой книгой
        Catalog --> Lib : shelf
        Lib -> Shelf : перечисление ячеек
        Shelf --> Lib : cell
        Lib -> Cell : Remove(book)

        Lib -> BookRepo : RemoveBook(book)
        Lib --> Librarian : "Книга списана из фонда"
    end
end
@enduml
```

![Списание книги](Списание%20книги.png)
